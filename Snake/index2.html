<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>index2</title>

    <style>

        body{
            background-image: url("bilder/ørken.jpg");

            background-size: auto;
        }

        .square {
            background: red;
            width: 20px;
            height: 20px;
            margin: 5px auto;
            position: absolute;
        }

        .eple {
            background: blue;
            width: 20px;
            height: 20px;
            margin: 5px auto;
            position: absolute;
            border-radius: 50%;
        }

        #ramme{
            border: solid 2px;
            left: 400px;
            top: 100px;
            width: 500px;
            height: 500px;
            position: absolute;
        }

        #poengSum{
            position: absolute;
            bottom: 50px;
            left: 50%;
        }
        #overSkrift{
            position: absolute;
            left: 48%;
            top: 24px;
        }

        #startBtn{
            position: absolute;
            width: 100px;
            height: 100px;
            left: 600px;
            top: 300px;
        }

        #gress{
            position: absolute;
            width: 500px;
            height: 500px;
            top: 102px;
            left: 402px;
        }


    </style>
    <img id="gress" src="bilder/gress.jpg">

    <h1 id="poengSum">0</h1>
    <h1 id="overSkrift">Snake</h1>


    <div id="ramme"></div>

    <button id="startBtn">Start</button>

    <audio id="dødLyd" src="Lyd/død.mp3"></audio>
    <audio id="spiseLyd" src="Lyd/nom.mp3"></audio>
    <audio id="musikk" src="Lyd/musikk.mp3"></audio>



</head>
<body>

<script>

    let startBtn = document.querySelector("#startBtn");
    let dødLyd = document.querySelector("#dødLyd");
    let spiseLyd = document.querySelector("#spiseLyd");
    let musikk = document.querySelector("#musikk");

    var i = 0;
    var y = 3;
    var e = 0;
    var h = 4;
    let squares = [];
    let epler = [];
    let leftArray = [];
    let topArray = [];
    let topPos = 97;
    let leftPos = 382;
    let epleTop = 0;
    let epleLeft = 0;
    let epleNummer = 0;

    lagEple();

    startBtn.onclick = function(){
        setInterval(lagFirkant, 150);
        startBtn.style.display = "none";
        musikk.play();
    };


    function dødFunction(){
        dødLyd.play();

        squares[i-3].parentElement.removeChild(squares[i-(5 + epleNummer)]);

        for(let b = 0; b < 5; b++){
            setTimeout(function () {
                h = h - 1;
                if(h === -1){
                    console.log("funker");
                    location.reload();
                }
            }, 1000 * b);
        }

    }

    function lagFirkant(){
        var square = document.createElement('div');
        square.className = 'square';
        square.id = "square" + i;
        document.body.appendChild(square);
        squares.push(square);


        if(y === 3) {
            leftPos += 20;
            //console.log(squares);
        }
        else if(y === 1){
            leftPos += -20;
        }
        else if(y === 2){
            topPos += -20;
        }
        else if(y === 4){
            topPos += 20;
        }


        if(topPos > 577 || topPos < 97 || leftPos > 892 || leftPos < 402){
            dødFunction();
        }

        square.style.left = leftPos + "px";
        square.style.top = topPos + "px";


        for(let l = 0; l < epleNummer + 5; l++){
            if(topPos + 5 === topArray[l] && leftPos === leftArray[l]){
                dødFunction();
            }
        }



        leftArray.push(square.offsetLeft);
        topArray.push(square.offsetTop);
        i++;


        if(topPos + 5 === epleTop && leftPos === epleLeft){
            epler[epleNummer].parentElement.removeChild(epler[epleNummer]);
            epleNummer++;
            spiseLyd.play();
            lagEple();
            document.getElementById("poengSum").innerHTML = epleNummer;
        }
        else if(i > 4){
            squares[i-3].parentElement.removeChild(squares[i-(5 + epleNummer)]);
            topArray.shift();
            leftArray.shift();
        }

    }


    function lagEple(){
        var eple = document.createElement('div');
        eple.className = 'eple';
        eple.id = "eple";
        document.body.appendChild(eple);
        epler.push(eple);


        e = Math.floor(Math.random() * 24 + 1);

        eple.style.left = ((e * 20) + 382) + "px";
        eple.style.top = ((e * 20) + 97) + "px";

        epleTop = epler[epleNummer].offsetTop;
        epleLeft = epler[epleNummer].offsetLeft;

    }


    document.onkeydown = function(e) {
        switch (e.keyCode) {
            case 37:
                console.log('left');
                if(y === 3){
                    break;
                }
                y = 1;
                break;
            case 38:
                console.log('up');
                if(y === 4){
                    break;
                }
                y = 2;
                break;
            case 39:
                console.log('right');
                if(y === 1){
                    break;
                }
                y = 3;
                break;
            case 40:
                console.log('down');
                if(y === 2){
                    break;
                }
                y = 4;
                break;
        }
    };




</script>


</body>
</html>